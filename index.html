<!-- âœ… DIGITAL NOTARY â€” MULTILINGUAL EDITION v4.5 (4 LANGUAGES) -->
<div id="notaryApp" class="dn-wrap">

  <!-- TÃœRKÃ‡E VERSÄ°YON -->
  <div class="lang-tr">
    <div class="dn-head">
      <div class="dn-badge">POART PROTOCOL</div>
      <h1 class="dn-title">DÄ°JÄ°TAL NOTER</h1>
      <p class="dn-sub">Eserinizi yÃ¼kleyin, kriptografik olarak mÃ¼hÃ¼rleyin ve resmi sertifikanÄ±zÄ± alÄ±n.</p>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">FotoÄŸrafÄ±nÄ±z</label>
        <div id="photoDrop" class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ“¸</div>
          <div class="dn-drop-title">SÃ¼rÃ¼kle bÄ±rak</div>
          <div class="dn-drop-sub">veya tÄ±klayÄ±p seÃ§in</div>
          <div id="photoMeta" class="dn-drop-meta"></div>
        </div>
        <input type="file" id="userPhoto" accept="image/*" class="dn-hidden-input" />
      </div>

      <div>
        <label class="dn-label">Eser DosyasÄ±</label>
        <div id="artDrop" class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ¨</div>
          <div class="dn-drop-title">SÃ¼rÃ¼kle bÄ±rak</div>
          <div class="dn-drop-sub">veya tÄ±klayÄ±p seÃ§in</div>
          <div id="artMeta" class="dn-drop-meta"></div>
        </div>
        <input type="file" id="artFile" accept="image/*,.pdf,.mp4" class="dn-hidden-input" />
      </div>
    </div>

    <div class="dn-grid" style="margin-top:-6px;">
      <div class="dn-preview-card">
        <div class="dn-preview-label">FotoÄŸraf Ã–nizleme</div>
        <img id="photoPreview" class="dn-preview-img" alt="" style="display:none;" />
        <div id="photoPreviewEmpty" class="dn-preview-empty">HenÃ¼z seÃ§ilmedi</div>
      </div>
      <div class="dn-preview-card">
        <div class="dn-preview-label">Eser Ã–nizleme</div>
        <img id="artPreview" class="dn-preview-img" alt="" style="display:none;" />
        <div id="artPreviewEmpty" class="dn-preview-empty">GÃ¶rsel deÄŸilse Ã¶nizleme olmaz</div>
      </div>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">Ãœretici / SanatÃ§Ä± AdÄ±</label>
        <input type="text" id="creatorName" placeholder="SanatÃ§Ä± adÄ±nÄ± girin" class="dn-input" />
      </div>
      <div>
        <label class="dn-label">Eser BaÅŸlÄ±ÄŸÄ±</label>
        <input type="text" id="artTitle" placeholder="Eser baÅŸlÄ±ÄŸÄ±nÄ± girin" class="dn-input" />
      </div>
    </div>

    <div class="dn-visibility-section">
      <div class="dn-visibility-header">
        <span class="dn-visibility-icon">ğŸ”</span>
        <span class="dn-visibility-title">ÃœÃ§ Gizlilik Modu: Tam Kontrol Sizde</span>
      </div>
      
      <p class="dn-visibility-intro">
        Her duruma uygun gizlilik seviyesi seÃ§ebilirsiniz. Ã–nemli not: 
        <strong class="dn-highlight">Hangi modu seÃ§erseniz seÃ§in, IP adresiniz hiÃ§bir zaman tam olarak gÃ¶rÃ¼nmez</strong> 
        â€” sistem her zaman maskeleyerek kaydeder (Ã¶rn: <code class="dn-code">192.168.***.***</code>).
      </p>

      <div class="dn-visibility-cards">
        <label class="dn-vis-card" data-value="private">
          <input type="radio" name="visibility" value="private" checked />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ”’</div>
            <div class="dn-vis-name">Ã–zel (Private)</div>
            <div class="dn-vis-desc">Sadece siz gÃ¶rÃ¼rsÃ¼nÃ¼z. HenÃ¼z paylaÅŸmak istemediÄŸiniz projeler iÃ§in ideal. Tarih damgasÄ± vurup bekletebilirsiniz.</div>
            <div class="dn-vis-badge private">Sunucuya gitmez</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="masked">
          <input type="radio" name="visibility" value="masked" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ•¶ï¸</div>
            <div class="dn-vis-name">Maskeli (Masked)</div>
            <div class="dn-vis-desc">MÃ¼hÃ¼r gÃ¶rÃ¼nÃ¼r, kimliÄŸiniz gizli. Anonim kalmak isteyen sanatÃ§Ä±lar iÃ§in. Konum ve cihaz bilgileri maskelenir.</div>
            <div class="dn-vis-badge masked">Anonim kayÄ±t</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="public">
          <input type="radio" name="visibility" value="public" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸŒ</div>
            <div class="dn-vis-name">Herkese AÃ§Ä±k (Public)</div>
            <div class="dn-vis-desc">Tam ÅŸeffaflÄ±k. Tarih, ÅŸehir ve cihaz bilgileri gÃ¶rÃ¼nÃ¼r. <em>(IP yine de maskelenir)</em></div>
            <div class="dn-vis-badge public">Tam ÅŸeffaflÄ±k</div>
          </div>
        </label>
      </div>

      <div class="dn-table-section">
        <div class="dn-table-header">
          <span class="dn-table-icon">ğŸ“Š</span>
          <span class="dn-table-title">Ã–rnek iÃ§in bakÄ±nÄ±z: Modlar KarÅŸÄ±laÅŸtÄ±rmasÄ±</span>
        </div>
        <div class="dn-table-wrapper">
          <table class="dn-comparison-table">
            <thead>
              <tr>
                <th>Mod</th>
                <th>Sunucu</th>
                <th>IP</th>
                <th>Konum</th>
                <th>Cihaz</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="dn-table-mode">ğŸ”’ Ã–zel<br><span class="dn-table-mode-sub">(Private)</span></span></td>
                <td><span class="dn-table-badge red">âœ• Gitmez</span></td>
                <td><span class="dn-table-na">Yok</span></td>
                <td><span class="dn-table-na">Yok</span></td>
                <td><span class="dn-table-na">Yok</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸ•¶ï¸ Maskeli<br><span class="dn-table-mode-sub">(Masked)</span></span></td>
                <td><span class="dn-table-badge green">âœ“ Kaydedilir</span></td>
                <td><code class="dn-table-code" id="tableMaskedIP">46.1.***.***</code></td>
                <td><code class="dn-table-code" id="tableMaskedLoc">*** / TÃ¼rkiye</code></td>
                <td><span class="dn-table-text">Gizli</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸŒ Herkese AÃ§Ä±k<br><span class="dn-table-mode-sub">(Public)</span></span></td>
                <td><span class="dn-table-badge green">âœ“ Kaydedilir</span></td>
                <td><code class="dn-table-code" id="tablePublicIP">46.1.***.***</code></td>
                <td><code class="dn-table-code" id="tablePublicLoc">Ä°stanbul, TÃ¼rkiye</code></td>
                <td><span class="dn-table-text">GÃ¶sterilir</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="dn-privacy-guarantee">
        <span class="dn-guarantee-icon">ğŸ›¡ï¸</span>
        <div class="dn-guarantee-text">
          <strong>Gizlilik Garantisi:</strong> DosyanÄ±z sunucuya yÃ¼klenmez, hash hesaplamasÄ± tarayÄ±cÄ±nÄ±zda yapÄ±lÄ±r. 
          "Herkese AÃ§Ä±k" modda bile IP adresiniz <code class="dn-code" id="liveIPPreview">***.***.***.***</code> 
          formatÄ±nda maskelenerek gÃ¶sterilir â€” tam IP asla kaydedilmez.
        </div>
      </div>
    </div>

    <button id="sealBtn" class="dn-btn">
      <span class="dn-btn-icon">ğŸª¶</span>
      <span>MÃœHÃœRLE & SERTÄ°FÄ°KA OLUÅTUR</span>
    </button>

    <div id="statusBox" class="dn-status" style="display:none;"></div>

    <div id="previewSection" class="dn-preview-section" style="display:none;">
      <div class="dn-preview-head">
        <div class="dn-preview-title">ğŸ“œ Sertifika HazÄ±r</div>
        <div class="dn-preview-actions">
          <button id="downloadPNG" class="dn-mini-btn" type="button">ğŸ–¼ï¸ PNG</button>
          <button id="downloadJSON" class="dn-mini-btn" type="button">ğŸ’¾ JSON</button>
          <button id="downloadPDF" class="dn-mini-btn" type="button">ğŸ“„ PDF</button>
        </div>
      </div>
      <div id="certPreview" class="dn-cert-container"></div>
    </div>
  </div>

  <!-- Ä°NGÄ°LÄ°ZCE VERSÄ°YON -->
  <div class="lang-en">
    <div class="dn-head">
      <div class="dn-badge">POART PROTOCOL</div>
      <h1 class="dn-title">DIGITAL NOTARY</h1>
      <p class="dn-sub">Upload your artwork, seal it cryptographically, and receive your official certificate.</p>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">Your Photo</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ“¸</div>
          <div class="dn-drop-title">Drag & Drop</div>
          <div class="dn-drop-sub">or click to select</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>

      <div>
        <label class="dn-label">Artwork File</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ¨</div>
          <div class="dn-drop-title">Drag & Drop</div>
          <div class="dn-drop-sub">or click to select</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>
    </div>

    <div class="dn-grid" style="margin-top:-6px;">
      <div class="dn-preview-card">
        <div class="dn-preview-label">Photo Preview</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">Not selected yet</div>
      </div>
      <div class="dn-preview-card">
        <div class="dn-preview-label">Artwork Preview</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">No preview for non-images</div>
      </div>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">Creator / Artist Name</label>
        <input type="text" placeholder="Enter artist name" class="dn-input" />
      </div>
      <div>
        <label class="dn-label">Artwork Title</label>
        <input type="text" placeholder="Enter artwork title" class="dn-input" />
      </div>
    </div>

    <div class="dn-visibility-section">
      <div class="dn-visibility-header">
        <span class="dn-visibility-icon">ğŸ”</span>
        <span class="dn-visibility-title">Three Privacy Modes: Full Control is Yours</span>
      </div>
      
      <p class="dn-visibility-intro">
        Choose the privacy level that suits your situation. Important note: 
        <strong class="dn-highlight">Regardless of which mode you choose, your IP address is never fully visible</strong> 
        â€” the system always masks it (e.g., <code class="dn-code">192.168.***.***</code>).
      </p>

      <div class="dn-visibility-cards">
        <label class="dn-vis-card" data-value="private">
          <input type="radio" name="visibility" value="private" checked />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ”’</div>
            <div class="dn-vis-name">Private</div>
            <div class="dn-vis-desc">Only you can see it. Ideal for projects you don't want to share yet. Timestamp and wait.</div>
            <div class="dn-vis-badge private">Not sent to server</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="masked">
          <input type="radio" name="visibility" value="masked" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ•¶ï¸</div>
            <div class="dn-vis-name">Masked</div>
            <div class="dn-vis-desc">Seal visible, identity hidden. For artists who want to remain anonymous. Location and device info masked.</div>
            <div class="dn-vis-badge masked">Anonymous record</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="public">
          <input type="radio" name="visibility" value="public" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸŒ</div>
            <div class="dn-vis-name">Public</div>
            <div class="dn-vis-desc">Full transparency. Date, city, and device info visible. <em>(IP still masked)</em></div>
            <div class="dn-vis-badge public">Full transparency</div>
          </div>
        </label>
      </div>

      <div class="dn-table-section">
        <div class="dn-table-header">
          <span class="dn-table-icon">ğŸ“Š</span>
          <span class="dn-table-title">Mode Comparison Table</span>
        </div>
        <div class="dn-table-wrapper">
          <table class="dn-comparison-table">
            <thead>
              <tr>
                <th>Mode</th>
                <th>Server</th>
                <th>IP</th>
                <th>Location</th>
                <th>Device</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="dn-table-mode">ğŸ”’ Private</span></td>
                <td><span class="dn-table-badge red">âœ• Not sent</span></td>
                <td><span class="dn-table-na">None</span></td>
                <td><span class="dn-table-na">None</span></td>
                <td><span class="dn-table-na">None</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸ•¶ï¸ Masked</span></td>
                <td><span class="dn-table-badge green">âœ“ Saved</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">*** / Turkey</code></td>
                <td><span class="dn-table-text">Hidden</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸŒ Public</span></td>
                <td><span class="dn-table-badge green">âœ“ Saved</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">Istanbul, Turkey</code></td>
                <td><span class="dn-table-text">Shown</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="dn-privacy-guarantee">
        <span class="dn-guarantee-icon">ğŸ›¡ï¸</span>
        <div class="dn-guarantee-text">
          <strong>Privacy Guarantee:</strong> Your file is not uploaded to the server; hash calculation is done in your browser. 
          Even in "Public" mode, your IP address is masked in <code class="dn-code">***.***.***.***</code> 
          format â€” full IP is never recorded.
        </div>
      </div>
    </div>

    <button class="dn-btn">
      <span class="dn-btn-icon">ğŸª¶</span>
      <span>SEAL & CREATE CERTIFICATE</span>
    </button>

    <div class="dn-status" style="display:none;"></div>

    <div class="dn-preview-section" style="display:none;">
      <div class="dn-preview-head">
        <div class="dn-preview-title">ğŸ“œ Certificate Ready</div>
        <div class="dn-preview-actions">
          <button class="dn-mini-btn" type="button">ğŸ–¼ï¸ PNG</button>
          <button class="dn-mini-btn" type="button">ğŸ’¾ JSON</button>
          <button class="dn-mini-btn" type="button">ğŸ“„ PDF</button>
        </div>
      </div>
      <div class="dn-cert-container"></div>
    </div>
  </div>

  <!-- Ã‡Ä°NCE VERSÄ°YON -->
  <div class="lang-zh">
    <div class="dn-head">
      <div class="dn-badge">POART PROTOCOL</div>
      <h1 class="dn-title">æ•°å­—å…¬è¯</h1>
      <p class="dn-sub">ä¸Šä¼ æ‚¨çš„ä½œå“ï¼ŒåŠ å¯†å¯†å°ï¼Œå¹¶è·å–æ‚¨çš„å®˜æ–¹è¯ä¹¦ã€‚</p>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">æ‚¨çš„ç…§ç‰‡</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ“¸</div>
          <div class="dn-drop-title">æ‹–æ”¾æ–‡ä»¶</div>
          <div class="dn-drop-sub">æˆ–ç‚¹å‡»é€‰æ‹©</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>

      <div>
        <label class="dn-label">ä½œå“æ–‡ä»¶</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ¨</div>
          <div class="dn-drop-title">æ‹–æ”¾æ–‡ä»¶</div>
          <div class="dn-drop-sub">æˆ–ç‚¹å‡»é€‰æ‹©</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>
    </div>

    <div class="dn-grid" style="margin-top:-6px;">
      <div class="dn-preview-card">
        <div class="dn-preview-label">ç…§ç‰‡é¢„è§ˆ</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">å°šæœªé€‰æ‹©</div>
      </div>
      <div class="dn-preview-card">
        <div class="dn-preview-label">ä½œå“é¢„è§ˆ</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">éå›¾ç‰‡æ— é¢„è§ˆ</div>
      </div>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">åˆ›ä½œè€… / è‰ºæœ¯å®¶å§“å</label>
        <input type="text" placeholder="è¾“å…¥è‰ºæœ¯å®¶å§“å" class="dn-input" />
      </div>
      <div>
        <label class="dn-label">ä½œå“æ ‡é¢˜</label>
        <input type="text" placeholder="è¾“å…¥ä½œå“æ ‡é¢˜" class="dn-input" />
      </div>
    </div>

    <div class="dn-visibility-section">
      <div class="dn-visibility-header">
        <span class="dn-visibility-icon">ğŸ”</span>
        <span class="dn-visibility-title">ä¸‰ç§éšç§æ¨¡å¼ï¼šå®Œå…¨æ§åˆ¶æƒåœ¨æ‚¨æ‰‹ä¸­</span>
      </div>
      
      <p class="dn-visibility-intro">
        é€‰æ‹©é€‚åˆæ‚¨æƒ…å†µçš„éšç§çº§åˆ«ã€‚é‡è¦æç¤ºï¼š
        <strong class="dn-highlight">æ— è®ºæ‚¨é€‰æ‹©å“ªç§æ¨¡å¼ï¼Œæ‚¨çš„IPåœ°å€æ°¸è¿œä¸ä¼šå®Œå…¨å¯è§</strong> 
        â€” ç³»ç»Ÿå§‹ç»ˆä¼šè¿›è¡Œæ©ç å¤„ç†ï¼ˆä¾‹å¦‚ï¼š<code class="dn-code">192.168.***.***</code>ï¼‰ã€‚
      </p>

      <div class="dn-visibility-cards">
        <label class="dn-vis-card" data-value="private">
          <input type="radio" name="visibility" value="private" checked />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ”’</div>
            <div class="dn-vis-name">ç§å¯†</div>
            <div class="dn-vis-desc">ä»…æ‚¨å¯è§ã€‚é€‚åˆæ‚¨æš‚æ—¶ä¸æƒ³åˆ†äº«çš„é¡¹ç›®ã€‚æ—¶é—´æˆ³å¹¶ç­‰å¾…ã€‚</div>
            <div class="dn-vis-badge private">ä¸å‘é€åˆ°æœåŠ¡å™¨</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="masked">
          <input type="radio" name="visibility" value="masked" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ•¶ï¸</div>
            <div class="dn-vis-name">æ©ç </div>
            <div class="dn-vis-desc">å°ç« å¯è§ï¼Œèº«ä»½éšè—ã€‚é€‚åˆå¸Œæœ›ä¿æŒåŒ¿åçš„è‰ºæœ¯å®¶ã€‚ä½ç½®å’Œè®¾å¤‡ä¿¡æ¯å·²æ©ç ã€‚</div>
            <div class="dn-vis-badge masked">åŒ¿åè®°å½•</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="public">
          <input type="radio" name="visibility" value="public" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸŒ</div>
            <div class="dn-vis-name">å…¬å¼€</div>
            <div class="dn-vis-desc">å®Œå…¨é€æ˜ã€‚æ—¥æœŸã€åŸå¸‚å’Œè®¾å¤‡ä¿¡æ¯å¯è§ã€‚<em>ï¼ˆIPä»ç„¶æ©ç ï¼‰</em></div>
            <div class="dn-vis-badge public">å®Œå…¨é€æ˜</div>
          </div>
        </label>
      </div>

      <div class="dn-table-section">
        <div class="dn-table-header">
          <span class="dn-table-icon">ğŸ“Š</span>
          <span class="dn-table-title">æ¨¡å¼å¯¹æ¯”è¡¨</span>
        </div>
        <div class="dn-table-wrapper">
          <table class="dn-comparison-table">
            <thead>
              <tr>
                <th>æ¨¡å¼</th>
                <th>æœåŠ¡å™¨</th>
                <th>IP</th>
                <th>ä½ç½®</th>
                <th>è®¾å¤‡</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="dn-table-mode">ğŸ”’ ç§å¯†</span></td>
                <td><span class="dn-table-badge red">âœ• ä¸å‘é€</span></td>
                <td><span class="dn-table-na">æ— </span></td>
                <td><span class="dn-table-na">æ— </span></td>
                <td><span class="dn-table-na">æ— </span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸ•¶ï¸ æ©ç </span></td>
                <td><span class="dn-table-badge green">âœ“ å·²ä¿å­˜</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">*** / åœŸè€³å…¶</code></td>
                <td><span class="dn-table-text">éšè—</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸŒ å…¬å¼€</span></td>
                <td><span class="dn-table-badge green">âœ“ å·²ä¿å­˜</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">ä¼Šæ–¯å¦å¸ƒå°”, åœŸè€³å…¶</code></td>
                <td><span class="dn-table-text">æ˜¾ç¤º</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="dn-privacy-guarantee">
        <span class="dn-guarantee-icon">ğŸ›¡ï¸</span>
        <div class="dn-guarantee-text">
          <strong>éšç§ä¿è¯ï¼š</strong>æ‚¨çš„æ–‡ä»¶ä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼›å“ˆå¸Œè®¡ç®—åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­å®Œæˆã€‚
          å³ä½¿åœ¨"å…¬å¼€"æ¨¡å¼ä¸‹ï¼Œæ‚¨çš„IPåœ°å€ä¹Ÿä»¥ <code class="dn-code">***.***.***.***</code> 
          æ ¼å¼æ©ç  â€” å®Œæ•´IPæ°¸è¿œä¸ä¼šè¢«è®°å½•ã€‚
        </div>
      </div>
    </div>

    <button class="dn-btn">
      <span class="dn-btn-icon">ğŸª¶</span>
      <span>å¯†å°å¹¶åˆ›å»ºè¯ä¹¦</span>
    </button>

    <div class="dn-status" style="display:none;"></div>

    <div class="dn-preview-section" style="display:none;">
      <div class="dn-preview-head">
        <div class="dn-preview-title">ğŸ“œ è¯ä¹¦å·²å‡†å¤‡å¥½</div>
        <div class="dn-preview-actions">
          <button class="dn-mini-btn" type="button">ğŸ–¼ï¸ PNG</button>
          <button class="dn-mini-btn" type="button">ğŸ’¾ JSON</button>
          <button class="dn-mini-btn" type="button">ğŸ“„ PDF</button>
        </div>
      </div>
      <div class="dn-cert-container"></div>
    </div>
  </div>

  <!-- Ä°SPANYOLCA VERSÄ°YON -->
  <div class="lang-es">
    <div class="dn-head">
      <div class="dn-badge">POART PROTOCOL</div>
      <h1 class="dn-title">NOTARIO DIGITAL</h1>
      <p class="dn-sub">Sube su obra de arte, selle criptogrÃ¡ficamente y reciba su certificado oficial.</p>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">Su Foto</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ“¸</div>
          <div class="dn-drop-title">Arrastrar y soltar</div>
          <div class="dn-drop-sub">o haga clic para seleccionar</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>

      <div>
        <label class="dn-label">Archivo de Obra</label>
        <div class="dn-drop" role="button" tabindex="0">
          <div class="dn-drop-icon">ğŸ¨</div>
          <div class="dn-drop-title">Arrastrar y soltar</div>
          <div class="dn-drop-sub">o haga clic para seleccionar</div>
          <div class="dn-drop-meta"></div>
        </div>
      </div>
    </div>

    <div class="dn-grid" style="margin-top:-6px;">
      <div class="dn-preview-card">
        <div class="dn-preview-label">Vista previa de foto</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">AÃºn no seleccionado</div>
      </div>
      <div class="dn-preview-card">
        <div class="dn-preview-label">Vista previa de obra</div>
        <img class="dn-preview-img" alt="" style="display:none;" />
        <div class="dn-preview-empty">Sin vista previa para no imÃ¡genes</div>
      </div>
    </div>

    <div class="dn-grid">
      <div>
        <label class="dn-label">Creador / Nombre del Artista</label>
        <input type="text" placeholder="Ingrese el nombre del artista" class="dn-input" />
      </div>
      <div>
        <label class="dn-label">TÃ­tulo de la Obra</label>
        <input type="text" placeholder="Ingrese el tÃ­tulo de la obra" class="dn-input" />
      </div>
    </div>

    <div class="dn-visibility-section">
      <div class="dn-visibility-header">
        <span class="dn-visibility-icon">ğŸ”</span>
        <span class="dn-visibility-title">Tres Modos de Privacidad: El Control Total es Suyo</span>
      </div>
      
      <p class="dn-visibility-intro">
        Elija el nivel de privacidad que se adapte a su situaciÃ³n. Nota importante: 
        <strong class="dn-highlight">Independientemente del modo que elija, su direcciÃ³n IP nunca es completamente visible</strong> 
        â€” el sistema siempre la enmascara (ej.: <code class="dn-code">192.168.***.***</code>).
      </p>

      <div class="dn-visibility-cards">
        <label class="dn-vis-card" data-value="private">
          <input type="radio" name="visibility" value="private" checked />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ”’</div>
            <div class="dn-vis-name">Privado</div>
            <div class="dn-vis-desc">Solo usted puede verlo. Ideal para proyectos que aÃºn no desea compartir. Marca de tiempo y espera.</div>
            <div class="dn-vis-badge private">No se envÃ­a al servidor</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="masked">
          <input type="radio" name="visibility" value="masked" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸ•¶ï¸</div>
            <div class="dn-vis-name">Enmascarado</div>
            <div class="dn-vis-desc">Sello visible, identidad oculta. Para artistas que desean permanecer anÃ³nimos. InformaciÃ³n de ubicaciÃ³n y dispositivo enmascarada.</div>
            <div class="dn-vis-badge masked">Registro anÃ³nimo</div>
          </div>
        </label>

        <label class="dn-vis-card" data-value="public">
          <input type="radio" name="visibility" value="public" />
          <div class="dn-vis-card-inner">
            <div class="dn-vis-icon">ğŸŒ</div>
            <div class="dn-vis-name">PÃºblico</div>
            <div class="dn-vis-desc">Transparencia total. Fecha, ciudad e informaciÃ³n del dispositivo visibles. <em>(IP aÃºn enmascarada)</em></div>
            <div class="dn-vis-badge public">Transparencia total</div>
          </div>
        </label>
      </div>

      <div class="dn-table-section">
        <div class="dn-table-header">
          <span class="dn-table-icon">ğŸ“Š</span>
          <span class="dn-table-title">Tabla de ComparaciÃ³n de Modos</span>
        </div>
        <div class="dn-table-wrapper">
          <table class="dn-comparison-table">
            <thead>
              <tr>
                <th>Modo</th>
                <th>Servidor</th>
                <th>IP</th>
                <th>UbicaciÃ³n</th>
                <th>Dispositivo</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="dn-table-mode">ğŸ”’ Privado</span></td>
                <td><span class="dn-table-badge red">âœ• No enviado</span></td>
                <td><span class="dn-table-na">Ninguno</span></td>
                <td><span class="dn-table-na">Ninguno</span></td>
                <td><span class="dn-table-na">Ninguno</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸ•¶ï¸ Enmascarado</span></td>
                <td><span class="dn-table-badge green">âœ“ Guardado</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">*** / TurquÃ­a</code></td>
                <td><span class="dn-table-text">Oculto</span></td>
              </tr>
              <tr>
                <td><span class="dn-table-mode">ğŸŒ PÃºblico</span></td>
                <td><span class="dn-table-badge green">âœ“ Guardado</span></td>
                <td><code class="dn-table-code">46.1.***.***</code></td>
                <td><code class="dn-table-code">Estambul, TurquÃ­a</code></td>
                <td><span class="dn-table-text">Mostrado</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="dn-privacy-guarantee">
        <span class="dn-guarantee-icon">ğŸ›¡ï¸</span>
        <div class="dn-guarantee-text">
          <strong>GarantÃ­a de Privacidad:</strong> Su archivo no se carga en el servidor; el cÃ¡lculo de hash se realiza en su navegador. 
          Incluso en modo "PÃºblico", su direcciÃ³n IP se enmascara en formato <code class="dn-code">***.***.***.***</code> 
          â€” la IP completa nunca se registra.
        </div>
      </div>
    </div>

    <button class="dn-btn">
      <span class="dn-btn-icon">ğŸª¶</span>
      <span>SELLAR Y CREAR CERTIFICADO</span>
    </button>

    <div class="dn-status" style="display:none;"></div>

    <div class="dn-preview-section" style="display:none;">
      <div class="dn-preview-head">
        <div class="dn-preview-title">ğŸ“œ Certificado Listo</div>
        <div class="dn-preview-actions">
          <button class="dn-mini-btn" type="button">ğŸ–¼ï¸ PNG</button>
          <button class="dn-mini-btn" type="button">ğŸ’¾ JSON</button>
          <button class="dn-mini-btn" type="button">ğŸ“„ PDF</button>
        </div>
      </div>
      <div class="dn-cert-container"></div>
    </div>
  </div>

</div>

<canvas id="certCanvas" style="display:none;"></canvas>

<style>
  :root {
    --dn-primary: #059669;
    --dn-primary-dark: #047857;
    --dn-primary-darker: #065f46;
    --dn-primary-light: #10b981;
    --dn-primary-lighter: #34d399;
    --dn-accent: #6ee7b7;
    --dn-gray-50: #f9fafb;
    --dn-gray-100: #f3f4f6;
    --dn-gray-200: #e5e7eb;
    --dn-gray-300: #d1d5db;
    --dn-gray-400: #9ca3af;
    --dn-gray-500: #6b7280;
    --dn-gray-600: #4b5563;
    --dn-gray-700: #374151;
    --dn-gray-800: #1f2937;
    --dn-gray-900: #111827;
  }

  .dn-wrap{
    max-width: 920px;
    margin: 0 auto;
    padding: 48px 52px;
    border-radius: 28px;
    background: linear-gradient(165deg, 
      #ffffff 0%, 
      #f9fafb 25%,
      #f3f4f6 50%,
      #ecfdf5 75%,
      #d1fae5 100%
    );
    box-shadow: 
      0 25px 80px rgba(5, 150, 105, 0.08),
      0 10px 40px rgba(0, 0, 0, 0.04),
      inset 0 1px 0 rgba(255, 255, 255, 0.9);
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
    border: 1px solid rgba(5, 150, 105, 0.12);
    position: relative;
    overflow: hidden;
  }

  .dn-wrap::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, 
      var(--dn-primary-dark) 0%,
      var(--dn-primary) 25%,
      var(--dn-primary-light) 50%,
      var(--dn-primary-lighter) 75%,
      var(--dn-accent) 100%
    );
  }

  .dn-head{ 
    text-align: center; 
    margin-bottom: 36px;
    padding-bottom: 28px;
    border-bottom: 1px solid rgba(5, 150, 105, 0.1);
  }

  .dn-badge {
    display: inline-block;
    padding: 6px 16px;
    background: linear-gradient(135deg, var(--dn-primary-darker), var(--dn-primary-dark));
    color: #d1fae5;
    font-size: 11px;
    font-weight: 800;
    letter-spacing: 2.5px;
    border-radius: 100px;
    margin-bottom: 16px;
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.25);
  }

  .dn-title{
    font-weight: 900;
    font-size: 38px;
    background: linear-gradient(135deg, var(--dn-gray-800) 0%, var(--dn-primary-darker) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: -0.03em;
    margin: 0 0 12px 0;
  }

  .dn-sub{ 
    margin: 0; 
    color: var(--dn-gray-500); 
    font-size: 15px; 
    line-height: 1.6;
    font-weight: 500;
  }

  .dn-grid{
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }

  .dn-label{ 
    font-weight: 700; 
    font-size: 13px; 
    color: var(--dn-gray-700); 
    margin-bottom: 10px; 
    display: block;
    letter-spacing: 0.3px;
  }

  .dn-input{
    width: 100%;
    padding: 14px 16px;
    border: 2px solid var(--dn-gray-200);
    border-radius: 14px;
    background: linear-gradient(180deg, #ffffff 0%, var(--dn-gray-50) 100%);
    outline: none;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    font-size: 14px;
    font-weight: 500;
    color: var(--dn-gray-800);
    box-sizing: border-box;
  }

  .dn-input::placeholder {
    color: var(--dn-gray-400);
  }

  .dn-input:hover {
    border-color: var(--dn-gray-300);
  }

  .dn-input:focus{
    border-color: var(--dn-primary);
    box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.1);
    background: #ffffff;
  }

  .dn-drop{
    border: 2px dashed var(--dn-gray-300);
    background: linear-gradient(145deg, #ffffff 0%, var(--dn-gray-50) 50%, rgba(236, 253, 245, 0.5) 100%);
    border-radius: 18px;
    padding: 24px 18px;
    cursor: pointer;
    user-select: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    min-height: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    text-align: center;
  }

  .dn-drop:hover{ 
    border-color: var(--dn-primary-light);
    background: linear-gradient(145deg, #ffffff 0%, #f0fdf4 50%, #ecfdf5 100%);
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(5, 150, 105, 0.1);
  }

  .dn-drop.is-over{ 
    border-color: var(--dn-primary);
    border-style: solid;
    background: linear-gradient(145deg, #ecfdf5 0%, #d1fae5 100%);
    box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.12);
  }

  .dn-drop-icon {
    font-size: 28px;
    margin-bottom: 4px;
  }

  .dn-drop-title{ 
    font-weight: 800; 
    color: var(--dn-gray-700);
    font-size: 14px;
  }

  .dn-drop-sub{ 
    color: var(--dn-gray-400); 
    font-size: 12px;
    font-weight: 500;
  }

  .dn-drop-meta{ 
    color: var(--dn-primary-dark); 
    font-size: 11px; 
    font-weight: 700; 
    margin-top: 6px;
    padding: 4px 10px;
    background: rgba(5, 150, 105, 0.08);
    border-radius: 6px;
  }

  .dn-hidden-input{ display: none; }

  .dn-preview-card{
    border: 1px solid var(--dn-gray-200);
    border-radius: 16px;
    background: linear-gradient(180deg, #ffffff 0%, var(--dn-gray-50) 100%);
    padding: 14px;
    min-height: 150px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.02);
  }

  .dn-preview-label{ 
    font-weight: 800; 
    color: var(--dn-gray-600); 
    font-size: 11px; 
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
  }

  .dn-preview-img{ 
    width: 100%; 
    height: 100px; 
    object-fit: cover; 
    border-radius: 12px; 
    border: 1px solid var(--dn-gray-200);
  }

  .dn-preview-empty{ 
    color: var(--dn-gray-400); 
    font-size: 12px; 
    padding: 30px 0 0; 
    text-align: center;
    font-weight: 500;
  }

  .dn-visibility-section {
    background: linear-gradient(145deg, #ffffff 0%, #f0fdf4 100%);
    border: 2px solid rgba(5, 150, 105, 0.15);
    border-radius: 20px;
    padding: 28px;
    margin: 24px 0;
  }

  .dn-visibility-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
  }

  .dn-visibility-icon {
    font-size: 24px;
  }

  .dn-visibility-title {
    font-size: 18px;
    font-weight: 800;
    color: var(--dn-primary-darker);
  }

  .dn-visibility-intro {
    font-size: 14px;
    color: var(--dn-gray-600);
    line-height: 1.7;
    margin-bottom: 20px;
  }

  .dn-highlight {
    color: var(--dn-gray-900);
    font-weight: 800;
    background: linear-gradient(135deg, rgba(5, 150, 105, 0.12), rgba(16, 185, 129, 0.08));
    padding: 2px 6px;
    border-radius: 4px;
  }

  .dn-code {
    background: linear-gradient(135deg, var(--dn-primary-darker), var(--dn-primary-dark));
    color: #ffffff;
    padding: 4px 12px;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    font-weight: 800;
    box-shadow: 0 2px 8px rgba(5, 150, 105, 0.15);
  }

  .dn-visibility-cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 40px;
  }

  .dn-vis-card {
    cursor: pointer;
    position: relative;
  }

  .dn-vis-card input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  .dn-vis-card-inner {
    background: #ffffff;
    border: 2px solid var(--dn-gray-200);
    border-radius: 16px;
    padding: 20px 16px;
    text-align: center;
    transition: all 0.3s ease;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .dn-vis-card:hover .dn-vis-card-inner {
    border-color: var(--dn-primary-light);
    box-shadow: 0 8px 25px rgba(5, 150, 105, 0.12);
    transform: translateY(-2px);
  }

  .dn-vis-card input:checked + .dn-vis-card-inner {
    border-color: var(--dn-primary);
    background: linear-gradient(145deg, #f0fdf4 0%, #ecfdf5 100%);
    box-shadow: 0 8px 30px rgba(5, 150, 105, 0.18);
  }

  .dn-vis-icon {
    font-size: 32px;
    margin-bottom: 12px;
  }

  .dn-vis-name {
    font-size: 14px;
    font-weight: 800;
    color: var(--dn-primary-dark);
    margin-bottom: 10px;
  }

  .dn-vis-desc {
    font-size: 12px;
    color: var(--dn-gray-500);
    line-height: 1.5;
    flex-grow: 1;
  }

  .dn-vis-desc em {
    color: var(--dn-gray-400);
    font-style: italic;
  }

  .dn-vis-badge {
    margin-top: 14px;
    padding: 6px 12px;
    border-radius: 100px;
    font-size: 10px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .dn-vis-badge.private {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    color: #92400e;
  }

  .dn-vis-badge.masked {
    background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
    color: #3730a3;
  }

  .dn-vis-badge.public {
    background: linear-gradient(135deg, #d1fae5, #a7f3d0);
    color: var(--dn-primary-darker);
  }

  .dn-privacy-guarantee {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
    border: 1px solid var(--dn-accent);
    border-left: 4px solid var(--dn-primary);
    border-radius: 12px;
    padding: 16px 20px;
  }

  .dn-table-section {
    margin-top: 24px;
    margin-bottom: 20px;
  }

  .dn-table-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
    padding: 14px 20px;
    background: linear-gradient(135deg, var(--dn-primary-darker) 0%, var(--dn-primary-dark) 50%, var(--dn-primary) 100%);
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.25);
  }

  .dn-table-icon {
    font-size: 24px;
    filter: brightness(1.2);
  }

  .dn-table-title {
    font-size: 16px;
    font-weight: 800;
    color: #ffffff;
    letter-spacing: 0.3px;
  }

  .dn-table-wrapper {
    overflow-x: auto;
    border-radius: 14px;
    border: 1px solid var(--dn-gray-200);
    background: #ffffff;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .dn-comparison-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }

  .dn-comparison-table thead {
    background: linear-gradient(135deg, var(--dn-gray-50) 0%, #f0fdf4 100%);
  }

  .dn-comparison-table th {
    padding: 14px 16px;
    text-align: left;
    font-weight: 800;
    color: var(--dn-gray-700);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 2px solid var(--dn-gray-200);
  }

  .dn-comparison-table td {
    padding: 16px;
    border-bottom: 1px solid var(--dn-gray-100);
    vertical-align: middle;
  }

  .dn-comparison-table tbody tr:last-child td {
    border-bottom: none;
  }

  .dn-comparison-table tbody tr:hover {
    background: linear-gradient(135deg, rgba(240, 253, 244, 0.5), rgba(236, 253, 245, 0.5));
  }

  .dn-table-mode {
    font-weight: 700;
    color: var(--dn-gray-800);
    font-size: 13px;
    line-height: 1.4;
  }

  .dn-table-mode-sub {
    font-weight: 600;
    color: var(--dn-gray-500);
    font-size: 11px;
  }

  .dn-table-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 5px 10px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 700;
  }

  .dn-table-badge.red {
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    color: #dc2626;
  }

  .dn-table-badge.green {
    background: linear-gradient(135deg, #f0fdf4, #dcfce7);
    color: #16a34a;
  }

  .dn-table-na {
    color: var(--dn-gray-400);
    font-weight: 500;
    font-style: italic;
  }

  .dn-table-code {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    color: #92400e;
    padding: 4px 10px;
    border-radius: 6px;
    font-family: 'Courier New', monospace;
    font-size: 11px;
    font-weight: 700;
    white-space: nowrap;
  }

  .dn-table-text {
    color: var(--dn-gray-600);
    font-weight: 600;
  }

  .dn-guarantee-icon {
    font-size: 24px;
    flex-shrink: 0;
  }

  .dn-guarantee-text {
    font-size: 13px;
    color: var(--dn-gray-700);
    line-height: 1.6;
  }

  .dn-guarantee-text strong {
    color: var(--dn-primary-darker);
  }

  .dn-btn{
    width: 100%;
    padding: 18px 32px;
    border: none;
    border-radius: 16px;
    background: linear-gradient(135deg, 
      var(--dn-primary-dark) 0%,
      var(--dn-primary) 50%,
      var(--dn-primary-light) 100%
    );
    color: white;
    font-weight: 800;
    font-size: 15px;
    cursor: pointer;
    box-shadow: 
      0 8px 30px rgba(5, 150, 105, 0.35),
      0 2px 8px rgba(5, 150, 105, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
  }

  .dn-btn:hover{ 
    transform: translateY(-2px);
    box-shadow: 
      0 12px 40px rgba(5, 150, 105, 0.4),
      0 4px 12px rgba(5, 150, 105, 0.25),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  .dn-btn:active {
    transform: translateY(0);
  }

  .dn-btn:disabled{ 
    opacity: 0.6; 
    cursor: not-allowed; 
    transform: none;
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.2);
  }

  .dn-btn-icon {
    font-size: 18px;
  }

  .dn-status{ 
    text-align: center; 
    margin-top: 18px; 
    color: var(--dn-gray-600); 
    font-size: 14px; 
    font-weight: 600;
    padding: 14px 20px;
    background: linear-gradient(135deg, var(--dn-gray-50), #ffffff);
    border-radius: 12px;
    border: 1px solid var(--dn-gray-200);
  }

  .dn-preview-section{
    margin-top: 28px;
    border-radius: 20px;
    border: 2px solid rgba(5, 150, 105, 0.2);
    background: #ffffff;
    overflow: hidden;
    box-shadow: 0 10px 40px rgba(5, 150, 105, 0.08);
  }

  .dn-preview-head{
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 18px 22px;
    background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 50%, #d1fae5 100%);
    border-bottom: 2px solid rgba(5, 150, 105, 0.15);
  }

  .dn-preview-title{ 
    font-weight: 800; 
    color: var(--dn-primary-darker); 
    font-size: 16px;
    letter-spacing: 0.3px;
  }

  .dn-preview-actions{ 
    display: flex; 
    gap: 10px; 
  }

  .dn-mini-btn{
    padding: 10px 16px;
    border-radius: 10px;
    border: 2px solid rgba(5, 150, 105, 0.25);
    background: #ffffff;
    cursor: pointer;
    font-weight: 700;
    font-size: 12px;
    color: var(--dn-primary-dark);
    transition: all 0.25s ease;
  }

  .dn-mini-btn:hover{ 
    background: linear-gradient(135deg, #f0fdf4, #ecfdf5);
    border-color: var(--dn-primary);
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.15);
    transform: translateY(-1px);
  }

  .dn-cert-container{
    padding: 36px;
    background: linear-gradient(180deg, #ffffff 0%, var(--dn-gray-50) 100%);
  }

  .cert-frame{
    max-width: 800px;
    margin: 0 auto;
    background: linear-gradient(165deg, #ffffff 0%, var(--dn-gray-50) 50%, #f0fdf4 100%);
    border: 3px solid var(--dn-primary-darker);
    border-radius: 24px;
    padding: 0;
    overflow: hidden;
    box-shadow: 
      0 20px 60px rgba(0, 0, 0, 0.1),
      0 8px 25px rgba(5, 150, 105, 0.08);
  }

  .cert-header{
    background: linear-gradient(135deg, 
      var(--dn-gray-800) 0%,
      var(--dn-primary-darker) 40%,
      var(--dn-primary-dark) 70%,
      var(--dn-primary) 100%
    );
    padding: 36px 28px;
    text-align: center;
    position: relative;
  }

  .cert-header::after{
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 6px;
    background: linear-gradient(90deg, 
      var(--dn-primary-light), 
      var(--dn-primary-lighter), 
      var(--dn-accent), 
      var(--dn-primary-lighter), 
      var(--dn-primary-light)
    );
  }

  .cert-logo{
    font-family: 'Georgia', serif;
    font-size: 13px;
    font-weight: 700;
    color: var(--dn-accent);
    letter-spacing: 4px;
    margin-bottom: 14px;
  }

  .cert-title{
    font-family: 'Georgia', serif;
    font-size: 34px;
    font-weight: 900;
    color: white;
    letter-spacing: 1px;
    margin: 0;
    text-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
  }

  .cert-subtitle{
    font-size: 13px;
    color: #d1fae5;
    margin-top: 10px;
    font-weight: 500;
    letter-spacing: 0.5px;
  }

  .cert-body{
    padding: 36px 32px;
  }

  .cert-photos{
    display: grid;
    grid-template-columns: 120px 1fr 120px;
    gap: 24px;
    margin-bottom: 32px;
    align-items: center;
  }

  .cert-photo-frame{
    width: 120px;
    height: 120px;
    border-radius: 14px;
    border: 3px solid var(--dn-gray-300);
    overflow: hidden;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
  }

  .cert-photo-frame img{
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .cert-photo-label{
    text-align: center;
    font-size: 11px;
    color: var(--dn-gray-500);
    margin-top: 8px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .cert-artwork-main{
    border-radius: 16px;
    overflow: hidden;
    border: 3px solid var(--dn-gray-200);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
  }

  .cert-artwork-main img{
    width: 100%;
    height: auto;
    display: block;
  }

  .cert-qr{
    width: 120px;
    height: 120px;
    border: 3px solid var(--dn-primary);
    border-radius: 14px;
    padding: 8px;
    background: #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.15);
  }

  .cert-info-panel{
    background: linear-gradient(145deg, #ffffff 0%, #f0fdf4 50%, #ecfdf5 100%);
    border: 2px solid var(--dn-accent);
    border-radius: 18px;
    padding: 28px;
    margin-bottom: 24px;
    border-left: 6px solid var(--dn-primary);
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.06);
  }

  .cert-info-title{
    font-family: 'Georgia', serif;
    font-size: 20px;
    font-weight: 900;
    color: var(--dn-primary-darker);
    margin-bottom: 20px;
  }

  .cert-info-grid{
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px 24px;
  }

  .cert-info-item{
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .cert-info-label{
    font-size: 11px;
    font-weight: 800;
    color: var(--dn-primary);
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .cert-info-value{
    font-size: 14px;
    font-weight: 700;
    color: var(--dn-gray-800);
  }

  .cert-hash-panel{
    background: linear-gradient(145deg, var(--dn-gray-50) 0%, #ffffff 100%);
    border: 2px solid var(--dn-gray-200);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
  }

  .cert-hash-title{
    font-size: 13px;
    font-weight: 800;
    color: var(--dn-gray-600);
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .cert-hash-value{
    font-family: 'Courier New', monospace;
    font-size: 11px;
    color: var(--dn-gray-700);
    word-break: break-all;
    line-height: 1.7;
    background: #ffffff;
    padding: 14px;
    border-radius: 10px;
    border: 1px solid var(--dn-gray-200);
  }

  .cert-footer{
    padding-top: 24px;
    border-top: 2px solid var(--dn-gray-200);
    display: flex;
    justify-content: flex-end;
  }

  .cert-stamp{
    width: 95px;
    height: 95px;
    border: 4px double var(--dn-primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 900;
    color: var(--dn-primary-dark);
    transform: rotate(-15deg);
    background: radial-gradient(circle, #ffffff 0%, #f0fdf4 50%, #ecfdf5 100%);
    box-shadow: 0 4px 15px rgba(5, 150, 105, 0.15);
  }

  .cert-disclaimer{
    font-family: 'Georgia', serif;
    font-size: 11px;
    line-height: 1.7;
    color: var(--dn-gray-500);
    text-align: center;
    font-style: italic;
    padding: 18px 24px;
    background: linear-gradient(135deg, var(--dn-gray-50), #ffffff);
    border-radius: 14px;
    border: 1px solid var(--dn-gray-200);
    margin-top: 24px;
  }

  .cert-local-badge {
    display: inline-block;
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    color: #92400e;
    padding: 4px 12px;
    border-radius: 100px;
    font-size: 10px;
    font-weight: 800;
    margin-left: 8px;
  }

  @media (max-width: 800px){
    .dn-wrap{ padding: 24px 20px; }
    .dn-grid{ grid-template-columns: 1fr; }
    .dn-visibility-cards { grid-template-columns: 1fr; }
    .cert-photos{ grid-template-columns: 1fr; }
    .cert-photo-frame{ margin: 0 auto; }
    .cert-info-grid{ grid-template-columns: 1fr; }
    .dn-title { font-size: 28px; }
  }
</style>
<!-- External Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
(async function () {
  const MESSAGES = {
    tr: {
      selectArtFirst: "LÃ¼tfen Ã¶nce bir eser seÃ§in!", onlyImages: "Sadece gÃ¶rsel kabul edilir",
      noPreview: "GÃ¶rsel deÄŸilse Ã¶nizleme yok", processing: "â³ Ä°ÅŸleniyor... Hash hesaplanÄ±yor...",
      savingSupabase: "ğŸ’¾ Supabase'e kaydediliyor...", creatingCert: "ğŸ“œ Sertifika oluÅŸturuluyor...",
      certReadyPrivate: "âœ… Sertifika hazÄ±r! ğŸ”’ Ã–zel mod: Sadece tarayÄ±cÄ±nÄ±zda oluÅŸturuldu.",
      certReadySupabase: "âœ… Sertifika hazÄ±r ve Supabase'e kaydedildi!", error: "âŒ Hata: {error}",
      pngDownloaded: "âœ… PNG indirildi!", jsonDownloaded: "âœ… JSON indirildi!", pdfDownloaded: "âœ… PDF indirildi!",
      certTitle: "DÄ°JÄ°TAL NOTER SERTÄ°FÄ°KASI", certSubtitle: "Ä°lhan Art Gallery tarafÄ±ndan verilmiÅŸtir",
      artworkName: "Eser AdÄ±", artistName: "SanatÃ§Ä±", certId: "Sertifika ID", date: "Tarih",
      unknown: "Bilinmiyor", untitled: "Ä°simsiz", hidden: "Gizli", privateMode: "ğŸ”’ YEREL",
      disclaimerPrivate: "Bu sertifika yalnÄ±zca tarayÄ±cÄ±nÄ±zda oluÅŸturulmuÅŸtur.",
      disclaimerPublic: "This certificate [PoArt] can be used as first-stage verification. Second-stage verification is only done on-site through the Public Registry."
    },
    en: {
      selectArtFirst: "Please select an artwork first!", onlyImages: "Only images accepted",
      noPreview: "No preview for non-images", processing: "â³ Processing...",
      savingSupabase: "ğŸ’¾ Saving...", creatingCert: "ğŸ“œ Creating certificate...",
      certReadyPrivate: "âœ… Certificate ready! ğŸ”’ Private mode.", certReadySupabase: "âœ… Certificate ready!",
      error: "âŒ Error: {error}", pngDownloaded: "âœ… PNG downloaded!", jsonDownloaded: "âœ… JSON downloaded!",
      pdfDownloaded: "âœ… PDF downloaded!", certTitle: "DIGITAL NOTARY CERTIFICATE",
      certSubtitle: "Issued by Ä°lhan Art Gallery", artworkName: "Artwork Name", artistName: "Artist",
      certId: "Certificate ID", date: "Date", unknown: "Unknown", untitled: "Untitled", hidden: "Hidden",
      privateMode: "ğŸ”’ LOCAL", disclaimerPrivate: "This certificate was created only in your browser.",
      disclaimerPublic: "This certificate [PoArt] can be used as first-stage verification. Second-stage verification is only done on-site through the Public Registry."
    },
    zh: {
      selectArtFirst: "è¯·å…ˆé€‰æ‹©ä¸€ä»¶ä½œå“ï¼", onlyImages: "ä»…æ¥å—å›¾ç‰‡", noPreview: "éå›¾ç‰‡æ— é¢„è§ˆ",
      processing: "â³ å¤„ç†ä¸­...", savingSupabase: "ğŸ’¾ ä¿å­˜ä¸­...", creatingCert: "ğŸ“œ åˆ›å»ºè¯ä¹¦...",
      certReadyPrivate: "âœ… è¯ä¹¦å·²å‡†å¤‡å¥½ï¼ğŸ”’ ç§å¯†æ¨¡å¼", certReadySupabase: "âœ… è¯ä¹¦å·²å‡†å¤‡å¥½ï¼",
      error: "âŒ é”™è¯¯ï¼š{error}", pngDownloaded: "âœ… PNG å·²ä¸‹è½½ï¼", jsonDownloaded: "âœ… JSON å·²ä¸‹è½½ï¼",
      pdfDownloaded: "âœ… PDF å·²ä¸‹è½½ï¼", certTitle: "æ•°å­—å…¬è¯è¯ä¹¦", certSubtitle: "ç”±ä¼Šå°”æ±—è‰ºæœ¯ç”»å»Šé¢å‘",
      artworkName: "ä½œå“åç§°", artistName: "è‰ºæœ¯å®¶", certId: "è¯ä¹¦ç¼–å·", date: "æ—¥æœŸ",
      unknown: "æœªçŸ¥", untitled: "æ— æ ‡é¢˜", hidden: "éšè—", privateMode: "ğŸ”’ æœ¬åœ°",
      disclaimerPrivate: "æ­¤è¯ä¹¦ä»…åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­åˆ›å»ºã€‚",
      disclaimerPublic: "This certificate [PoArt] can be used as first-stage verification. Second-stage verification is only done on-site through the Public Registry.."
    },
    es: {
      selectArtFirst: "Â¡Seleccione una obra primero!", onlyImages: "Solo imÃ¡genes", noPreview: "Sin vista previa",
      processing: "â³ Procesando...", savingSupabase: "ğŸ’¾ Guardando...", creatingCert: "ğŸ“œ Creando certificado...",
      certReadyPrivate: "âœ… Â¡Certificado listo! ğŸ”’ Modo privado", certReadySupabase: "âœ… Â¡Certificado listo!",
      error: "âŒ Error: {error}", pngDownloaded: "âœ… Â¡PNG descargado!", jsonDownloaded: "âœ… Â¡JSON descargado!",
      pdfDownloaded: "âœ… Â¡PDF descargado!", certTitle: "CERTIFICADO DE NOTARIO DIGITAL",
      certSubtitle: "Emitido por Ä°lhan Art Gallery", artworkName: "Nombre de la Obra", artistName: "Artista",
      certId: "ID del Certificado", date: "Fecha", unknown: "Desconocido", untitled: "Sin tÃ­tulo",
      hidden: "Oculto", privateMode: "ğŸ”’ LOCAL", disclaimerPrivate: "Este certificado fue creado solo en su navegador.",
      disclaimerPublic: "This certificate [PoArt] can be used as first-stage verification. Second-stage verification is only done on-site through the Public Registry."
    }
  };

  function getCurrentLang() {
    const htmlLang = document.documentElement.lang;
    if (htmlLang.startsWith('tr')) return 'tr';
    if (htmlLang.startsWith('en')) return 'en';
    if (htmlLang.startsWith('zh')) return 'zh';
    if (htmlLang.startsWith('es')) return 'es';
    return 'tr';
  }

  function t(key, replacements = {}) {
    const lang = getCurrentLang();
    let msg = MESSAGES[lang][key] || MESSAGES.tr[key] || key;
    Object.keys(replacements).forEach(k => { msg = msg.replace(`{${k}}`, replacements[k]); });
    return msg;
  }

  const SUPABASE_URL = "https://immdfdvrwqcvgmflbgdr.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImltbWRmZHZyd3FjdmdtZmxiZ2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4NzU0MTgsImV4cCI6MjA4MzQ1MTQxOH0.MN05h2FLVFb14P9Oi0y3g3euqZjzGdVslJay6aQ1HkE";
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  // âœ… AYNI ID'LERÄ° KULLAN (suffix yok)
  const sealBtn = document.getElementById("sealBtn");
  const artFile = document.getElementById("artFile");
  const userPhoto = document.getElementById("userPhoto");
  const creatorName = document.getElementById("creatorName");
  const artTitle = document.getElementById("artTitle");
  const statusBox = document.getElementById("statusBox");
  const artDrop = document.getElementById("artDrop");
  const photoDrop = document.getElementById("photoDrop");
  const artMeta = document.getElementById("artMeta");
  const photoMeta = document.getElementById("photoMeta");
  const artPreview = document.getElementById("artPreview");
  const photoPreview = document.getElementById("photoPreview");
  const artPreviewEmpty = document.getElementById("artPreviewEmpty");
  const photoPreviewEmpty = document.getElementById("photoPreviewEmpty");
  const previewSection = document.getElementById("previewSection");
  const certPreview = document.getElementById("certPreview");
  const downloadPNG = document.getElementById("downloadPNG");
  const downloadJSON = document.getElementById("downloadJSON");
  const downloadPDF = document.getElementById("downloadPDF");
  const liveIPPreview = document.getElementById("liveIPPreview");
  const tableMaskedIP = document.getElementById("tableMaskedIP");
  const tablePublicIP = document.getElementById("tablePublicIP");
  const tableMaskedLoc = document.getElementById("tableMaskedLoc");
  const tablePublicLoc = document.getElementById("tablePublicLoc");

  let currentRecord = null, currentArtDataUrl = null, currentPhotoDataUrl = null, cachedIPData = null;

  function getVisibility() {
    const checked = document.querySelector('input[name="visibility"]:checked');
    return checked ? checked.value : 'private';
  }

  async function fetchIPData() {
    try {
      const res = await fetch("https://ipapi.co/json/");
      cachedIPData = await res.json();
      if (cachedIPData?.ip) {
        const maskedIP = maskIP(cachedIPData.ip);
        const city = cachedIPData.city || 'Unknown', country = cachedIPData.country_name || 'Unknown';
        if (liveIPPreview) liveIPPreview.textContent = maskedIP;
        if (tableMaskedIP) tableMaskedIP.textContent = maskedIP;
        if (tablePublicIP) tablePublicIP.textContent = maskedIP;
        if (tableMaskedLoc) tableMaskedLoc.textContent = `*** / ${country}`;
        if (tablePublicLoc) tablePublicLoc.textContent = `${city}, ${country}`;
      }
    } catch (e) { console.warn('IP fetch failed:', e); cachedIPData = null; }
  }
  fetchIPData();

  function setStatus(html, kind = "info") {
    if (!statusBox) return;
    statusBox.style.display = "block";
    const color = kind === "error" ? "#dc2626" : (kind === "ok" ? "#059669" : "#4b5563");
    statusBox.innerHTML = `<span style="color:${color};">${html}</span>`;
  }

  function setDropMeta(el, file) {
    if (!el || !file) { if (el) el.textContent = ""; return; }
    const sizeMb = (file.size / (1024 * 1024)).toFixed(2);
    el.textContent = `${file.name} â€¢ ${sizeMb} MB`;
  }

  function bindDropZone(zoneEl, inputEl, metaEl, onFile) {
    if (!zoneEl || !inputEl) {
      console.warn('âŒ bindDropZone: element not found', {zoneEl, inputEl});
      return;
    }
    
    console.log('âœ… Binding drop zone:', zoneEl.id || zoneEl.className);
    
    zoneEl.addEventListener("click", () => {
      console.log('ğŸ–±ï¸ Drop zone clicked');
      inputEl.click();
    });
    
    zoneEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        console.log('âŒ¨ï¸ Keyboard trigger');
        inputEl.click();
      }
    });

    ["dragenter","dragover"].forEach(evt => {
      zoneEl.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        zoneEl.classList.add("is-over");
      });
    });
    
    ["dragleave","drop"].forEach(evt => {
      zoneEl.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        zoneEl.classList.remove("is-over");
      });
    });
    
    zoneEl.addEventListener("drop", (e) => {
      const file = e.dataTransfer.files?.[0];
      if (!file) return;
      console.log('ğŸ“ File dropped:', file.name);
      inputEl.files = e.dataTransfer.files;
      setDropMeta(metaEl, file);
      onFile(file);
    });

    inputEl.addEventListener("change", () => {
      const file = inputEl.files?.[0];
      console.log('ğŸ“ File selected:', file?.name);
      setDropMeta(metaEl, file);
      if (file) onFile(file);
    });
  }

  bindDropZone(photoDrop, userPhoto, photoMeta, (file) => {
    if (!file.type.startsWith("image/")) {
      photoPreview.style.display = "none";
      photoPreviewEmpty.textContent = t('onlyImages');
      photoPreviewEmpty.style.display = "block";
      return;
    }
    const url = URL.createObjectURL(file);
    photoPreview.src = url;
    photoPreview.style.display = "block";
    photoPreviewEmpty.style.display = "none";
  });

  bindDropZone(artDrop, artFile, artMeta, (file) => {
    if (file.type.startsWith("image/")) {
      const url = URL.createObjectURL(file);
      artPreview.src = url;
      artPreview.style.display = "block";
      artPreviewEmpty.style.display = "none";
    } else {
      artPreview.style.display = "none";
      artPreviewEmpty.textContent = t('noPreview');
      artPreviewEmpty.style.display = "block";
    }
  });

  function maskIP(ip) {
    if (!ip) return "***.***.***.***";
    const parts = ip.split('.');
    return parts.length === 4 ? `${parts[0]}.${parts[1]}.***.***` : ip.substring(0, 6) + "****";
  }

  function maskLoc(city, country) { return `*** / ${country || 'Unknown'}`; }

  async function digest(buffer, algo) {
    const hashBuffer = await crypto.subtle.digest(algo, buffer);
    return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2,"0")).join("");
  }

  async function fileToDataUrl(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onerror = () => reject(new Error("FileReader failed"));
      reader.onload = () => resolve(reader.result);
      reader.readAsDataURL(file);
    });
  }

  function formatDate(iso) {
    try {
      const d = new Date(iso);
      const lang = getCurrentLang();
      const locale = lang === 'tr' ? 'tr-TR' : lang === 'zh' ? 'zh-CN' : lang === 'es' ? 'es-ES' : 'en-US';
      return d.toLocaleDateString(locale) + ' ' + d.toLocaleTimeString(locale, {hour:'2-digit', minute:'2-digit'});
    } catch { return iso; }
  }

  async function generateQR(text) {
    const canvas = document.createElement("canvas");
    await QRCode.toCanvas(canvas, text, { width: 110, color: { dark: "#065f46", light: "#ffffff" } });
    return canvas.toDataURL("image/png");
  }

  async function generateCertHTML(record, artDataUrl, photoDataUrl, qrDataUrl, visibility) {
    const photoHTML = photoDataUrl ? `<div><div class="cert-photo-frame"><img src="${photoDataUrl}" alt="User"></div><div class="cert-photo-label">${t('artistName')}</div></div>` : '';
    const artHTML = artDataUrl ? `<div class="cert-artwork-main"><img src="${artDataUrl}" alt="Artwork"></div>` : 
      `<div class="cert-artwork-main" style="min-height:200px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f9fafb,#f0fdf4);">
        <div style="text-align:center;color:#6b7280;"><div style="font-size:48px;margin-bottom:8px;">ğŸ“„</div><div style="font-weight:700;">${record.title}</div></div></div>`;
    
    let extraInfoHTML = '';
    if (visibility === 'public' || visibility === 'masked') {
      extraInfoHTML = `<div class="cert-info-item"><div class="cert-info-label">Konum</div><div class="cert-info-value">${record.location_data}</div></div>
        <div class="cert-info-item"><div class="cert-info-label">IP</div><div class="cert-info-value">${record.origin_ip}</div></div>`;
    }

    const localBadge = visibility === 'private' ? `<span class="cert-local-badge">${t('privateMode')}</span>` : '';
    const lang = getCurrentLang();
    const verifiedText = lang === 'tr' ? 'ONAYLANDI' : lang === 'zh' ? 'å·²éªŒè¯' : lang === 'es' ? 'VERIFICADO' : 'VERIFIED';

    return `<div class="cert-frame"><div class="cert-header"><div class="cert-logo">POART PROTOCOL</div><h2 class="cert-title">${t('certTitle')} ${localBadge}</h2><div class="cert-subtitle">${t('certSubtitle')}</div></div>
      <div class="cert-body"><div class="cert-photos">${photoHTML}${artHTML}<div><div class="cert-qr"><img src="${qrDataUrl}" style="width:100%;height:auto;" alt="QR"></div><div class="cert-photo-label">QR</div></div></div>
      <div class="cert-info-panel"><div class="cert-info-title">Sertifika Bilgileri</div><div class="cert-info-grid">
        <div class="cert-info-item"><div class="cert-info-label">${t('artworkName')}</div><div class="cert-info-value">${record.title}</div></div>
        <div class="cert-info-item"><div class="cert-info-label">${t('artistName')}</div><div class="cert-info-value">${record.creator}</div></div>
        <div class="cert-info-item"><div class="cert-info-label">${t('certId')}</div><div class="cert-info-value">${record.cert_id}</div></div>
        <div class="cert-info-item"><div class="cert-info-label">${t('date')}</div><div class="cert-info-value">${formatDate(record.created_at)}</div></div>${extraInfoHTML}
      </div></div>
      <div class="cert-hash-panel"><div class="cert-hash-title">ğŸ” Hash Fingerprints</div>
        <div style="margin-bottom:12px;"><div style="font-size:10px;font-weight:800;color:#6b7280;margin-bottom:5px;">SHA-256:</div><div class="cert-hash-value">${record.sha256}</div></div>
        <div><div style="font-size:10px;font-weight:800;color:#6b7280;margin-bottom:5px;">SHA-512:</div><div class="cert-hash-value">${record.sha512}</div></div>
      </div>
      <div class="cert-disclaimer">${t('disclaimerPublic')}</div>
      <div class="cert-footer"><div class="cert-stamp">âœ“<br>${verifiedText}</div></div></div></div>`;
  }

  if (sealBtn && artFile) {
    sealBtn.addEventListener("click", async () => {
      if (!artFile.files.length) { alert(t('selectArtFirst')); return; }
      previewSection.style.display = "none";
      certPreview.innerHTML = "";
      const visibility = getVisibility();
      
      try {
        sealBtn.disabled = true;
        setStatus(t('processing'), "info");
        const file = artFile.files[0];
        const buffer = await file.arrayBuffer();
        const sha256 = await digest(buffer, "SHA-256");
        const sha512 = await digest(buffer, "SHA-512");
        
        let ip = "***.***.***.***", loc = t('hidden');
        if (visibility !== 'private' && cachedIPData) {
          ip = maskIP(cachedIPData.ip);
          loc = visibility === 'public' ? `${cachedIPData.city || t('unknown')}, ${cachedIPData.country_name || t('unknown')}` : maskLoc(cachedIPData.city, cachedIPData.country_name);
        }
        
        const record = {
          cert_id: "POART-" + Math.random().toString(36).substring(2, 10).toUpperCase(),
          title: artTitle.value || t('untitled'),
          creator: creatorName.value || t('unknown'),
          sha256, sha512, visibility,
          device_info: visibility === 'public' ? navigator.userAgent : t('hidden'),
          location_data: loc, origin_ip: ip, created_at: new Date().toISOString()
        };
        currentRecord = record;
        
        currentArtDataUrl = file.type.startsWith("image/") ? await fileToDataUrl(file) : null;
        const userFile = userPhoto.files[0];
        currentPhotoDataUrl = userFile?.type.startsWith("image/") ? await fileToDataUrl(userFile) : null;
        
        let supabaseSuccess = false;
        if (visibility !== 'private') {
          setStatus(t('savingSupabase'), "info");
          try {
            const { error } = await sb.from("manifests").insert([record]);
            if (error) throw error;
            supabaseSuccess = true;
          } catch (e) { console.error('Supabase error:', e); }
        }
        
        const qrDataUrl = await generateQR(`https://www.ilhanart.org/public-registry}`);
        setStatus(t('creatingCert'), "info");
        const certHTML = await generateCertHTML(record, currentArtDataUrl, currentPhotoDataUrl, qrDataUrl, visibility);
        certPreview.innerHTML = certHTML;
        previewSection.style.display = "block";
        setStatus(visibility === 'private' ? t('certReadyPrivate') : t('certReadySupabase'), "ok");
      } catch (err) {
        setStatus(t('error', {error: err.message}), "error");
      } finally { sealBtn.disabled = false; }
    });
  }

  if (downloadPNG) {
    downloadPNG.addEventListener("click", async () => {
      if (!currentRecord || !certPreview) return;
      try {
        setStatus('ğŸ–¼ï¸ Creating PNG...', "info");
        const certElement = certPreview.querySelector('.cert-frame');
        const canvas = await html2canvas(certElement, { scale: 2, useCORS: true, backgroundColor: '#ffffff', logging: false });
        const link = document.createElement("a");
        link.download = `${currentRecord.cert_id}_Certificate.png`;
        link.href = canvas.toDataURL("image/png");
        link.click();
        setStatus(t('pngDownloaded'), "ok");
      } catch (e) { console.error(e); }
    });
  }

  if (downloadJSON) {
    downloadJSON.addEventListener("click", () => {
      if (!currentRecord) return;
      const jsonData = { ...currentRecord, verification_url: `https://www.ilhanart.org/public-registry}` };
      const blob = new Blob([JSON.stringify(jsonData, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${currentRecord.cert_id}_Data.json`;
      link.click();
      setStatus(t('jsonDownloaded'), "ok");
    });
  }

  if (downloadPDF) {
    downloadPDF.addEventListener("click", async () => {
      if (!currentRecord || !certPreview) return;
      try {
        setStatus('ğŸ“„ Creating PDF...', "info");
        const { jsPDF } = window.jspdf;
        if (!jsPDF) throw new Error("jsPDF not loaded");
        const certElement = certPreview.querySelector('.cert-frame');
        const canvas = await html2canvas(certElement, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });
        const imgData = canvas.toDataURL("image/png");
        const pdf = new jsPDF("p", "mm", "a4");
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const imgWidth = pdfWidth - 20;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        pdf.addImage(imgData, "PNG", 10, 10, imgWidth, imgHeight);
        pdf.save(`${currentRecord.cert_id}_Certificate.pdf`);
        setStatus(t('pdfDownloaded'), "ok");
      } catch (e) { console.error(e); }
    });
  }

  console.log('âœ… Digital Notary initialized for language:', getCurrentLang());
})();
</script>
